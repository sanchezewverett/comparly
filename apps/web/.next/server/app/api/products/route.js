(()=>{var e={};e.id=146,e.ids=[146],e.modules={408:()=>{},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2463:(e,r,t)=>{"use strict";t.d(r,{M:()=>s,X:()=>n});var a=t(6151);let s=a.z.object({page:a.z.coerce.number().min(1).default(1),pageSize:a.z.coerce.number().min(1).max(100).default(10),name:a.z.string().optional(),category:a.z.coerce.number().optional(),minPrice:a.z.coerce.number().optional(),maxPrice:a.z.coerce.number().optional(),brand:a.z.string().optional()}),n=a.z.object({id:a.z.string().regex(/^\d+$/).transform(Number)})},2523:(e,r,t)=>{"use strict";t.d(r,{z:()=>s});let a=require("@prisma/client"),s=globalThis.prisma??new a.PrismaClient({log:["query"]})},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6800:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>p,serverHooks:()=>y,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{GET:()=>d});var s=t(8106),n=t(8819),o=t(2050),i=t(7818),c=t(9167),u=t(2463);let d=(0,i.K)({query:u.M},async({query:e})=>{let r=await (0,c.Q)(e);return Response.json(r)}),p=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"/Users/adamsmichal/Projects/commercial/movement/comparly/apps/web/src/app/api/products/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:y}=p;function f(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},7032:()=>{},7818:(e,r,t)=>{"use strict";function a(e,r){return async function(t,a){let s={},n={};if(e.params){let r=await a.params,t=e.params.safeParse(r);t.success?n.params=t.data:s.params=t.error.flatten()}if(e.query){let r=Object.fromEntries(new URL(t.url).searchParams.entries()),a=e.query.safeParse(r);a.success?n.query=a.data:s.query=a.error.flatten()}if(e.body)try{let r=await t.json(),a=e.body.safeParse(r);a.success?n.body=a.data:s.body=a.error.flatten()}catch{s.body={formErrors:["Invalid JSON"],fieldErrors:{}}}return Object.keys(s).length>0?Response.json({error:"Validation error",issues:s},{status:400}):r(n,t,a)}}t.d(r,{K:()=>a})},9167:(e,r,t)=>{"use strict";t.d(r,{G:()=>i,Q:()=>o});var a=t(2523);let s=async({page:e,pageSize:r,name:t,category:s,minPrice:n,maxPrice:o,brand:i})=>{let c={};t&&(c.name={contains:t,mode:"insensitive"}),s&&(c.category={id:s}),n&&(c.price={gte:n}),o&&(c.price={lte:o}),i&&(c.brand={contains:i,mode:"insensitive"});let[u,d]=await Promise.all([a.z.product.findMany({where:c,skip:(e-1)*r,take:r,include:{category:!0}}),a.z.product.count({where:c})]);return{data:u,page:e,pageSize:r,total:d,totalPages:Math.ceil(d/r)}},n=async e=>a.z.product.findUnique({where:{id:e},include:{category:!0,client:!0}}),o=async({page:e,pageSize:r,name:t,category:a,minPrice:n,maxPrice:o,brand:i})=>s({page:e,pageSize:r,name:t,category:a,minPrice:n,maxPrice:o,brand:i}),i=async e=>{let r=await n(e);if(!r)throw Error("Product not found");return r}},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[50,738],()=>t(6800));module.exports=a})();