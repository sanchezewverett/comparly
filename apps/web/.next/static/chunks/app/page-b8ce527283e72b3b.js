(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4981:(e,r,a)=>{Promise.resolve().then(a.bind(a,6044))},6044:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>A});var t=a(4568),n=a(7620),i=a(2942),l=a(3560),o=a(8113),s=a(5336),d=a(4925),c=a(8732),u=a(147),m=a(5201),h=a(1399),x=a(662),g=a(3795),p=a(952),f=a(5044),j=a(305),b=a(7261),v=a.n(b);let y=e=>{var r;let{product:a}=e;return(0,t.jsx)(v(),{href:"/products/".concat(a.id),style:{textDecoration:"none"},children:(0,t.jsxs)(p.A,{variant:"outlined",sx:{height:350,"&:hover":{boxShadow:4}},children:[(0,t.jsx)(f.A,{component:"img",image:a.imageUrl||"./placeholder.png",alt:a.name,sx:{height:160,objectFit:"scale-down"}}),(0,t.jsxs)(j.A,{sx:{flexGrow:1},children:[(0,t.jsxs)(s.A,{children:[(0,t.jsx)(d.default,{variant:"h6",fontWeight:"bold",gutterBottom:!0,sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:a.name,children:a.name}),(0,t.jsx)(d.default,{variant:"body2",color:"text.secondary",noWrap:!0,children:null==(r=a.category)?void 0:r.name})]}),(0,t.jsxs)(d.default,{variant:"body1",fontWeight:"medium",mt:2,children:[Number(a.price/100)," ",a.currency]})]}),(0,t.jsx)(s.A,{sx:{p:2,pt:0},children:(0,t.jsx)(m.default,{href:a.productUrl,target:"_blank",rel:"noopener noreferrer",variant:"contained",color:"primary",fullWidth:!0,onClick:e=>e.stopPropagation(),children:"Zobacz w sklepie"})})]})})},w=e=>{let{products:r}=e;return(0,t.jsx)(g.A,{container:!0,spacing:3,children:r.map(e=>(0,t.jsx)(g.A,{size:{xs:12,sm:6,md:4,lg:3},sx:{minWidth:250},children:(0,t.jsx)(y,{product:e})},e.id))})};var P=a(3297);async function W(e){let{page:r=1,category:a,name:t,minPrice:n,maxPrice:i,brand:l}=e,o=new URLSearchParams({page:String(r),pageSize:"16",...a?{category:a}:{},...l?{brand:l}:{},...t?{name:t}:{},...void 0!==n?{minPrice:String(100*n)}:{},...void 0!==i?{maxPrice:String(100*i)}:{}}),s=await fetch("/api/products?".concat(o));if(!s.ok)throw Error("Failed to fetch products");return s.json()}async function k(){let e=await fetch("/api/filters");if(!e.ok)throw Error("Nie udało się pobrać kategorii");let{data:r}=await e.json();return r}function A(){var e;let r=(0,i.useSearchParams)(),a=(0,i.useRouter)(),{data:g,isLoading:p}=(0,P.I)({queryKey:["filters"],queryFn:k,staleTime:6e5}),[f,j]=(0,n.useState)({name:r.get("name")||"",category:r.get("category")||"",brand:r.get("brand")||"",minPrice:r.get("minPrice")||"",maxPrice:r.get("maxPrice")||""}),[b,v]=(0,n.useState)(f),{data:y,isLoading:A,isError:S}=(e={page:parseInt(r.get("page")||"1",10),...b,minPrice:b.minPrice?Number(b.minPrice):void 0,maxPrice:b.maxPrice?Number(b.maxPrice):void 0},(0,P.I)({queryKey:["products",e],queryFn:()=>W(e),staleTime:6e4})),C=e=>{let{name:r,value:a}=e.target;j(e=>({...e,[r]:a}))};return(0,t.jsx)(l.default,{maxWidth:"xl",sx:{py:4},children:(0,t.jsxs)(o.default,{direction:"row",spacing:4,alignItems:"flex-start",children:[(0,t.jsxs)(s.A,{component:"form",onSubmit:e=>{e.preventDefault(),v(f);let r=new URLSearchParams;r.set("page","1"),Object.entries(f).forEach(e=>{let[a,t]=e;t&&r.set(a,t)}),a.push("/?".concat(r.toString()))},sx:{minWidth:300,maxWidth:300},children:[(0,t.jsx)(d.default,{variant:"h6",gutterBottom:!0,children:"Filtry"}),(0,t.jsxs)(c.default,{select:!0,label:"Kategoria",name:"category",value:f.category,onChange:C,fullWidth:!0,margin:"normal",disabled:p,children:[(0,t.jsx)(u.A,{value:"",children:"Wszystkie"}),null==g?void 0:g.categories.map(e=>(0,t.jsx)(u.A,{value:e.id,children:e.name},e.id))]}),(0,t.jsxs)(o.default,{direction:"row",spacing:2,sx:{py:1},children:[(0,t.jsx)(c.default,{label:"Cena od",name:"minPrice",type:"number",value:f.minPrice,onChange:C,fullWidth:!0,margin:"normal"}),(0,t.jsx)(c.default,{label:"Cena do",name:"maxPrice",type:"number",value:f.maxPrice,onChange:C,fullWidth:!0,margin:"normal"})]}),(0,t.jsxs)(c.default,{select:!0,label:"Producent",name:"brand",value:f.brand,onChange:C,fullWidth:!0,margin:"normal",disabled:p,children:[(0,t.jsx)(u.A,{value:"",children:"Wszystkie"}),null==g?void 0:g.brands.map(e=>(0,t.jsx)(u.A,{value:e.brand,children:e.brand},e.brand))]}),(0,t.jsx)(m.default,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Szukaj"})]}),(0,t.jsx)(o.default,{width:"100%",children:A?(0,t.jsx)(o.default,{justifyContent:"center",mt:4,children:(0,t.jsx)(h.A,{})}):S?(0,t.jsx)(d.default,{color:"error",mt:4,children:"Nie udało się załadować produkt\xf3w."}):y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w,{products:y.data}),(0,t.jsx)(o.default,{mt:4,direction:"row",justifyContent:"center",children:(0,t.jsx)(x.A,{count:y.totalPages,page:y.page,onChange:(e,r)=>{a.push("/?page=".concat(r))},color:"primary"})})]}):null})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[310,542,877,170,587,315,358],()=>r(4981)),_N_E=e.O()}]);